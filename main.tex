\documentclass[reqno]{amsart}
\usepackage{amsmath,amssymb,amsthm,amsfonts}
\usepackage{physics}
\usepackage{graphicx}
\usepackage[hidelinks]{hyperref}
\usepackage{babel}
\usepackage{datetime}
\usepackage{ragged2e}
\usepackage{siunitx}
\usepackage{enumerate}
\usepackage{pgf}
\usepackage{lmodern}
\usepackage{import}
\usepackage{tikz}

% ----------------------------------------------------------------
\let\oldtocsection=\tocsection

\let\oldtocsubsection=\tocsubsection

\let\oldtocsubsubsection=\tocsubsubsection

\renewcommand{\tocsection}[2]{\hspace{0em}\oldtocsection{#1}{#2}}
\renewcommand{\tocsubsection}[2]{\hspace{1em}\oldtocsubsection{#1}{#2}}
\renewcommand{\tocsubsubsection}[2]{\hspace{2em}\oldtocsubsubsection{#1}{#2}}
\makeatletter
\renewcommand\subsection{\@startsection{subsection}{2}%
  \z@{.5\linespacing\@plus.7\linespacing}{-.5em}%
  {\normalfont\scshape\justify}}
\makeatother
% ----------------------------------------------------------------

\newdateformat{monthyeardate}{%
  \monthname[\THEMONTH] \THEYEAR}
\numberwithin{equation}{section}
\numberwithin{figure}{section}
\tolerance=1
\emergencystretch=\maxdimen
\hyphenpenalty=10000
\hbadness=10000
\setcounter{tocdepth}{3}

\title{Ground State Energy Simulations Using Monte Carlo Random Walk}
\author[Elliott Ashby]{Elliott Ashby \\ Physics and Astronomy \\ University of Southamton}
\date{\monthyeardate\today}
% ----------------------------------------------------------------

\begin{document}
\begin{abstract}
    Placeholder for abstract.
\end{abstract}
\maketitle
\tableofcontents
\newpage
\section{Introduction}

% ----------------------- v TODO v ----------------------- % 

Overview of the challenges in solving the Schrödinger equation numerically
The connection between the imaginary-time Schrödinger equation and diffusion processes
Historical development of Monte Carlo methods in quantum mechanics
Brief comparison with alternative numerical approaches (matrix diagonalization, variational methods)
Motivation: why random walks are particularly well-suited for ground state energy calculations

% ----------------------- ^ TODO ^ ----------------------- %
\section{Method}
\subsection{Theoretical Foundation}

While the usage of Monte Carlo methods to simulate quantum mechanics may seem strange at first, looking at the time-dependent Schrödinger equation as a diffusion equation in imaginary time reveals the connection that makes it possible. Here is the time-dependent Schrödinger equation for a particle of mass $m$ in a potential $V(x)$:

\begin{equation}
    i\hbar\frac{\partial}{\partial t}\psi(x,t) = -\frac{\hbar^2}{2m}\frac{\partial^2}{\partial x^2}\psi(x,t) + V(x)\psi(x,t) = \hat{H}\psi(x,t)
\end{equation}

By using $\tau = it$, it becomes:

\begin{equation}
    \frac{\partial}{\partial \tau}\psi(x,\tau) = \frac{\hbar}{2m}\frac{\partial^2}{\partial x^2}\psi(x,\tau) - \frac{V(x)}{\hbar}\psi(x,\tau) = -\frac{\hat{H}}{\hbar}\psi(x,\tau)
    \label{eq:diffusion}
\end{equation}

This is a diffusion equation with a growth/decay term with a diffusion constant $D = \hbar/2m$ where the growth/decay term determines whether the population density of walkers at a given position increases or decreases. \\

The general solution to equation \ref{eq:diffusion} can be written using the eigenstates and eigenvalues of the Hamiltonian:

\begin{equation}
\psi(x,\tau) = \sum_n c_n \phi_n(x)e^{-E_n\tau/\hbar}
\end{equation}

where $\phi_n(x)$ are the eigenfunctions of the Hamiltonian with corresponding energies $E_n$, and $c_n$ represents the projection of the initial wavefunction onto each eigenstate. If we consider the case where $\tau \to \infty$, all terms decay exponentially, but the ground state decays the slowest:

\begin{equation}
\lim_{\tau \to \infty}\psi(x,\tau) = c_0\phi_0(x)e^{-E_0\tau/\hbar}
\end{equation}

If we then were able to simulate the diffusion process for a sufficiently long time, then the distribution of our random walkers would approach the ground state wavefunction $\phi_0(x)$, so the decay rate of the walker population would be the ground state energy $E_0$.

\subsection{Implementation Details}

In order to not have infinite computation time, we must discretize space and time. To do this we can use a lattice with spatial sites $j$ and temporal sites $n$. The probability $p(j,n)$ for a walker to be at lattice site $j$ after $n$ time steps satisfies:

\begin{figure}[h]
\begin{tikzpicture}[scale=1.5]
\def\hx{1}
\def\htau{1}

\draw[-] (-3.25*\hx, 0) -- (3.25*\hx, 0);
% Draw horizontal axis (x-axis)
\draw[->] (0, -0.5*\htau) -- (\hx, -0.5*\htau) node[below] {$x$};


\draw[-] (0, 0) -- (0, 3.25*\htau);
% Draw vertical axis (tau-axis)
\draw[->] (-0.5*\hx, 3*\htau) -- (-0.5*\hx, 3.25*\htau) node[right] {$\tau$};

% Draw lattice points
\foreach \i in {-3,-2,-1,0,1,2,3} {
    \foreach \j in {0,1,2,3} {
        \node[fill=black,circle,inner sep=1pt] at (\i*\hx, \j*\htau) {};
    }
}

\draw[-latex, shorten >=0.05cm] (0, 0) -- (-\hx, \htau);
\draw[-latex, shorten >=0.05cm] (0, 0) -- (\hx, \htau);
\draw[-latex, shorten >=0.05cm] (-\hx, \htau) -- (-2*\hx, 2*\htau);
\draw[-latex, shorten >=0.05cm] (-\hx, \htau) -- (0, 2*\htau);
\draw[-latex, shorten >=0.05cm] (\hx, \htau) -- (0, 2*\htau);
\draw[-latex, shorten >=0.05cm] (\hx, \htau) -- (2*\hx, 2*\htau);
\draw[-latex, shorten >=0.05cm] (0, 2*\htau) -- (-\hx, 3*\htau);
\draw[-latex, shorten >=0.05cm] (0, 2*\htau) -- (\hx, 3*\htau);
\draw[-latex, shorten >=0.05cm] (-2*\hx, 2*\htau) -- (-\hx, 3*\htau);
\draw[-latex, shorten >=0.05cm] (2*\hx, 2*\htau) -- (\hx, 3*\htau);
\draw[-latex, shorten >=0.05cm] (2*\hx, 2*\htau) -- (3*\hx, 3*\htau);
\draw[-latex, shorten >=0.05cm] (-2*\hx, 2*\htau) -- (-3*\hx, 3*\htau);

\node[below] at (-\hx, 0) {$-h_x$};
\node[below] at (0, 0) {$0 = x_i$};
\node[below] at (\hx, 0) {$h_x$};

\node[left] at (-3.25*\hx, 0) {$\tau_i$};
\node[left] at (-3.25*\hx, \htau) {$\tau_i + h_\tau$};

\node[below] at (-0.5*\hx, 0.5*\htau) {$\frac{1}{2}$};
\node[below] at (0.5*\hx, 0.5*\htau) {$\frac{1}{2}$};
\end{tikzpicture}
\caption{A lattice showing the possible moves of a walker at position $x_i$ and time $\tau_i$. The walker can move to any of the neighbouring sites with equal probability.}
\end{figure}

\begin{equation}
p(j,n+1) = \frac{1}{2}[1-a(j)][p(j-1,n) + p(j+1,n)]
\end{equation}

and converting to continuous space and time with intervals $h_x$ and $h_\tau$:

\begin{equation}
p(x, \tau + h_\tau) = \frac{1}{2} \left[1 - a(x)\right] \left[p(x - h_x, \tau) + p(x + h_x, \tau)\right]
\end{equation}

Here, $a(x)=h_\tau V(x)$ and represents the probability of a walker being absorbed at position $x$. \\

So for $\tau \to \infty$, swapping $\psi(x,\tau)$ for $p(x,\tau)$ and defining $h_\tau = h_x^2$ we get the final form of the diffusion equation:

\begin{equation}
    \frac{\partial p}{\partial \tau} = \frac{1}{2}\frac{\partial^2 p}{\partial x^2} - V(x)p
    \label{eq:diffusionFinal}
\end{equation}

\subsection{Algorithm Variants}

Using the diffusion equation \ref{eq:diffusionFinal} we can derive a couple different ways to simulate the ground state energy of a quantum system. \\

The simplest method is the simple absorption method, where walkers are absorbed at the boundaries of the lattice. This method is simple to implement but can be computationally expensive for large systems. \\

A more efficient method is the diffusion Monte Carlo method, which uses branching to kill and birth new walkers. This method is much more efficient but can be more difficult to implement due to the branching process.

\subsubsection{Simple Absorption Method}

In the case for the simple absorption method, our potential is implemented as a infinite square well potential. The probability of a walker being absorbed at a given position is given by:

\begin{equation}
    a(x) = \begin{cases}
        0 & \text{if } x \in [-L/2, L/2] \\
        1 & \text{otherwise}
    \end{cases}
\end{equation}

where $L$ is the width of the well. \\

Using this potential, we can implement the diffusion equation as a random walk on a lattice where:

\begin{equation}
    P_{survival}(\tau) = \int_{-L/2}^{L/2} p(x, \tau)^2 dx \approx e^{-\lambda \tau}
\end{equation}

where $\lambda$ is the decay rate of the population. \\

The algorithm is then as follows:

\fbox{\parbox{\textwidth}{
        Simple Absorption Method
        \begin{enumerate}
            \item Initialize the walker population at the centre of the lattice.
            \item For each walker, move it to a neighbouring lattice site with equal probability to move to any of the neighbouring sites.
            \item If the walker is at the boundary of the lattice ($x \geq L/2$), kill it and record the number of steps it took to reach the boundary.
            \item Repeat steps 2-3 for a maximum number of steps. If any of the walkers survive, mark them as surviving.
            \item Find the number of walkers that survive at each step and using a linear regression calculate the decay rate of the population $\lambda$.
            \item The ground state energy can then be approximated as $E_0 = \lambda (L/2)^2$.
        \end{enumerate}
}}


\subsubsection{Diffusion Monte Carlo with Branching}

The diffusion Monte Carlo with branching method is more complex than the simple absorption method and requires some additional theory. \\

One of the problems with the simple absorption method is that to get reasonable accuracy, a very large number of initial walkers is required. This can be a problem for large systems since the run time will be $O(N)$ where $N$ is the number of walkers since every walker must be simulated individually. \\

While we cannot lower the run time, we can lower the number of initial walkers and also greater our chances of finding the ground state. If we were to kill walkers that have a high probability of being absorbed and birth new walkers at positions with a low probability of being absorbed, we can attempt to maintain a more constant number of walkers throughout the simulation. \\

Since this approach requires us to find the probability of a walker being absorbed at some position, it is reasonable to use a potential that is continuous rather than the infinite square well potential. I have chosen to use the harmonic oscillator potential with $m = \omega = 1$:

\begin{equation}
    V(x) = \frac{1}{2}x^2
\end{equation}

The probability of a walker being absorbed at a given position is then:

\begin{equation}
    a(x) = h_\tau V(x) = \frac{1}{2}h_\tau x^2
\end{equation}

The algorithm is then as follows:

\fbox{\parbox{\textwidth}{
        Diffusion Monte Carlo with Branching
        \begin{enumerate}[(1)]
            \item
                \begin{enumerate}[(a)]
                    \item Initialize $N_0$ walkers in a Gaussian distribution around the centre of the lattice and record their positions $x_i$.
                    \item Compute initial reference potential energy $V_{ref} = \sum_{i} V(x_i)/N_0$.
                \end{enumerate}
            \item For each walker: 
                \begin{enumerate}[(a)]
                    \item Move it to a neighbouring lattice site with equal probability to move to any of the neighbouring sites.
                    \item Compute the potential energy at the new position $V(x)$ and compute the change in potential energy $\Delta V = V(x) - V_{ref}$.
                    \item If $\Delta V > 0$, kill the walker with probability $\abs{\Delta V \times h_\tau}$. Otherwise, birth a new walker at the new position with the same probability.
                \end{enumerate}
            \item Re-calculate 
                $V_{ref} \leftarrow \sum_{i}\frac{V(x_i)}{N_{a}} - k\left(\frac{N_{a} - N_{b}}{N_{b} \cdot h_\tau}\right)$ where $N_{a}$ is the number of walkers after step 2 and $N_{b}$ is the number of walkers before step 2 and $k$ is a constant to tune.
            \item Repeat steps 2-3 for a maximum number of steps or until the number of walkers reaches zero.
            \item The ground state energy can then be approximated as $E_0 = V_{ref}$.
        \end{enumerate}
}}

\section{Results}
\subsection{Simple Absorption Method}

% ----------------------- v TODO v ----------------------- % 

$params = \{N_0: 50, maxsteps: 10000, L: 20\}$ \\

Simulation Statistics:\\
Theoretical Value $(\pi^2/8)$: 1.233701\\
Average $\lambda (L/2)^2$: 1.228909 (residual: 0.004791)\\
Median $\lambda (L/2)^2$: 1.199329 (residual: 0.034371)\\
Mode $\lambda (L/2)^2$: 1.067469 (residual: 0.166232)\\
Standard Deviation: 0.337445\\
Range: [0.489469, 3.941426]\\
\\
Error Analysis:\\
Standard Error of Mean (SEM): 0.015091\\
Residual: 0.004791 ± 0.015091\\
Relative Error: 0.39%\\
95\% Confidence Interval: [1.199260, 1.258559]\\
✅ Theoretical value is within the 95\% confidence interval\\
\\
Bootstrap 95\% CI: [1.199885, 1.259244]\\
✅ Theoretical value is within the bootstrap confidence interval\\

\begin{figure}[h]
    \centering
    \import{./assets/one/}{histogram.pgf}
    \caption{For the Simple Absorption Method, a histogram showing the distribution of walkers with their energy values compared vs the theoretical value. A 95\% confidence interval is shown.}
    \label{fig:SA_histogram}
\end{figure}

\begin{figure}[h]
    \centering
    \import{./assets/one/}{convergence.pgf}
    \caption{For the Simple Absorption Method, a running mean of the walkers energy values compared vs the theoretical value as a function of walkers. A 95\% confidence interval is shown.}
    \label{fig:SA_convergence}
\end{figure}

\subsection{Diffusion Monte Carlo with Branching}

$params = \{N_0: 50, h_x: 0.1, maxsteps: 50000, w0: 1.0, k: 0.5, equilibration: 1000\}$ \\
==================================================\\
ENERGY STATISTICS\\
==================================================\\
Number of samples: 16705\\
Steps discarded: 1000\\
Theoretical ground state energy: 0.500000\\
--------------------------------------------------\\
Mean energy: 0.507812\\
Standard deviation: 0.016660\\
Standard error of the mean: 0.000129\\
95\% confidence interval: [0.507560, 0.508065]\\
--------------------------------------------------\\
Absolute error: 0.007812\\
Relative error: 1.56\%\\
--------------------------------------------------\\
Autocorrelation time: 971 Steps\\
Effective number of independent samples: 8.6\\
Corrected standard error: 0.005680\\
Corrected 95\% confidence interval: [0.494381, 0.521244]\\
==================================================\\
✅ Theoretical value (0.5) is within the 95\% confidence interval\\
==================================================\\
Final ground state energy estimate: 0.500528\\
Theoretical ground state energy: 0.500000\\

\begin{figure}[h]
    \centering
    \import{./assets/three/}{energy_vref.pgf}
    \caption{Time average mean potential energy of all walkers plotted with the estimate of the potential energy, $V_{ref}$ as a function of steps.}
    \label{fig:energy_vref}
\end{figure}

\begin{figure}[h]
    \centering
    \import{./assets/three/}{wave_function.pgf}
    \caption{For the Diffusion Monte Carlo with Branching method, Ground state wavefunction of potential $V(x) = \frac{1}{2}x^2$ at step 100, 500 and 50000 with the theoretical wavefunction as a function of position.}
    \label{fig:energy_vs_time}
\end{figure}

\begin{figure}[h]
    \centering
    \import{./assets/three/}{energy_convergence.pgf}
    \caption{For the Diffusion Monte Carlo with Branching method, the walkers energy and a mean of the walkers energy compared vs the theoretical value as a function of steps. A 95\% confidence interval is shown.}
    \label{fig:energy_convergence}
\end{figure}

\begin{figure}[h]
    \centering
    \import{./assets/three/}{energy_histogram.pgf}
    \caption{For the Diffusion Monte Carlo with Branching method, a histogram showing the distribution of walkers with their energy values compared vs the theoretical value. A Normal distribution is fitted to the data and a 95\% confidence interval to the mean is shown.}
    \label{fig:energy_histogram}
\end{figure}

\section{Discussion}
While extension to higher dimensions is straightforward, focusing on one-dimensional cases allows for easier visualization and comparison with analytical solutions. I opted to spend more time on the one-dimensional case since it allowed for easier debugging, testing and iteration of the code. \\
\subsection{Parameter Optimization}


\subsection{Method Strengths and Limitations}

\section{Conclusion}
Summary of key findings and method effectiveness
Practical recommendations for implementation
Future directions for method improvement
Potential applications to more complex quantum systems

\section*{Appendix}

\appendix
\section{Additional Citations}
18 Examples

6 for each: random walk, Monte Carlo, random numbers

3 in academia, 3 outside academia

\bibliographystyle{unsrtdin}
\bibliography{citations}
\end{document}
